@using Neosinerji.BABOnlineTP.Web.Content.Lang
@section HorizontalMenu
{
    <ul class="nav">
        <li class="active">
            <a href="#">@babonline.CommissionCalculate<span class="selected"></span></a>
        </li>
        <li>
            <span class="hor-menu-search-form-toggler">&nbsp;</span>
            <div class="search-form hidden-phone hidden-tablet">
                <form class="form-search">
                    <div class="input-append">
                        <input type="text" placeholder="@babonline.Search2" class="m-wrap">
                        <button type="button" class="btn"></button>
                    </div>
                </form>
            </div>
        </li>
    </ul>
}
@section PageHeader
{
}
@section PageScripts
{
    <style>
        .editable-input {
            height: 34px !important;
        }

        .collapse {
            display: block !important;
        }

        .price {
            text-align: right !important;
        }
    </style>
    <link href="@Url.Content("~/Content/Angular/css/bootstrap.min.css")" rel="stylesheet" />
    <link rel="stylesheet" href="@Url.Content("~/Content/Angular/css/style.css")" />
    <link rel="stylesheet" href="@Url.Content("~/Content/Angular/css/xeditable.css")" />
    <script data-require="angular.js@1.1.x" src="@Url.Content("~/Content/Angular/js/angular.min.js")" data-semver="1.1.5"></script>
    <script src="@Url.Content("~/Content/Angular/js/xeditable.js")"></script>
    <script src="@Url.Content("~/Content/Angular/js/multiselect.js")"></script>
    <script src="@Url.Content("~/Content/Angular/pagejs/komisyon.hesaplama.js")"></script>
    <script src="@Url.Content("~/Content/Angular/js/angular.babonline.resource.js")"></script>
    <script src="@Url.Content("~/Content/Angular/js/sweetalert.min.js")"></script>
    <link href="@Url.Content("~/Content/Angular/css/sweetalert.css")" rel="stylesheet" />
}
<div class="row-fluid" ng-app="komisyon.hesaplama" ng-controller="KomisyonHesaplamaCtrl">
    <div class="span12">
        <div class="portlet box light-grey" style="margin-top: 24px;">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-reorder"></i>
                    <span class="hidden-480" ng-bind="resource('commission_calculate')"></span>
                </div>
            </div>
            <div class="portlet-body form form-horizontal">
                <div class="row-fluid" style="padding-top: 10px;">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('policy_state')"></label>
                            <div class="controls">
                                <input type="radio" ng-model="filtre.PoliceDurumu" ng-value="0"><label ng-bind="resource('ps_uncalculated')"></label>
                                <input type="radio" ng-model="filtre.PoliceDurumu" ng-value="1"><label ng-bind="resource('ps_calculated')"></label>
                                <input type="radio" ng-model="filtre.PoliceDurumu" ng-value="2"><label ng-bind="resource('ps_all')"></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('sub_agency')"></label>
                            <div class="controls">
                                <multiselect class="input-xlarge" multiple="true"
                                             ng-model="filtre.TVMListe"
                                             options="c.Unvani for c in tvmler"
                                             change="selected()"></multiselect>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('outsource')"></label>
                            <div class="controls">
                                <multiselect class="input-xlarge" multiple="true"
                                             ng-model="filtre.DisKaynakListe"
                                             options="c.Unvani for c in disKaynaklar"
                                             change="selected()"></multiselect>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('branch')"></label>
                            <div class="controls">
                                <multiselect class="input-xlarge" multiple="true"
                                             ng-model="filtre.BransListe"
                                             options="b.Adi for b in branslar"
                                             change="selected()"></multiselect>
                            </div>
                        </div>
                    </div>
                    <div class="span6">
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('insurance_company')"></label>
                            <div class="controls">
                                <multiselect class="input-xlarge" multiple="true"
                                             ng-model="filtre.SigortaSirketiListe"
                                             options="s.Adi for s in sigortaSirketleri"
                                             change="selected()"></multiselect>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('policy_issue_date')"></label>
                            <div class="controls">
                                <a href="#" editable-date="filtre.TarihBaslangic" ng-bind="filtre.TarihBaslangic|date:'dd/MM/yyyy' || resource('enter_date')"></a><-->
                                    <a href="#" editable-date="filtre.TarihBitis" ng-bind="filtre.TarihBitis|date:'dd/MM/yyyy' || resource('enter_date')"></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid" style="padding-top: 10px;">
                    <div class="span6">
                        <div class="control-group">
                            <label class="control-label" ng-bind="resource('primary_type')"></label>
                            <div class="controls">
                                <input type="radio" ng-model="filtre.IptalZeylTahakkuk" ng-value="0"><label ng-bind="resource('canselZeyl')"></label>
                                <input type="radio" ng-model="filtre.IptalZeylTahakkuk" ng-value="1"><label ng-bind="resource('accrual')"></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span6">
                        <div class="control-group">
                            <div class="span12" style="padding-bottom: 20px; display: block;" ng-show="loading">
                                <div style="margin: 20px auto; width: 500px; text-align: center;">
                                    <h4>{{resource('please_waiting')}}</h4>
                                </div>
                                <div style="margin: 20px auto; width: 500px; text-align: center;">
                                    <img src="/Content/img/loading9.gif" width="32" height="32" title="{{resource('pw_detection_rate')}}" alt="{{resource('pw_detection_rate')}}">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <a id="search" class="btn green" data-loading-text="@babonline.Message_Loading" ng-click="postForm()" ng-bind="resource('list')"></a>
                </div>
                <div class="row-fluid" style="margin-top: 20px;">
                    <div class="span12">
                        <div id="table-div" style="overflow-x: auto; margin-top: 15px;">
                            <table class="table table-striped table-bordered table-hover dataTable data-table" style="table-layout: inherit">
                                <thead>
                                    <tr>
                                        <th style="width: 3%;">
                                            <input type="checkbox" ng-model="checkboxes.checked" id="select_all" name="filter-checkbox" value="" />
                                        </th>
                                        <th style="width: 14%;" ng-bind="resource('sub_agency_title')"></th>
                                        <th style="width: 14%;" ng-bind="resource('outsource')"></th>
                                        <th style="width: 10%;" ng-bind="resource('insurance_company')"></th>
                                        <th style="width: 10%;" ng-bind="resource('branch')"></th>
                                        <th style="width: 10%;" ng-bind="resource('net_premium')"></th>
                                        <th style="width: 10%;" ng-bind="resource('received_commission')"></th>
                                        <th style="width: 10%;" ng-bind="resource('policy_issue_date')"></th>
                                        <th style="width: 10%;" ng-bind="resource('policy_no')"></th>
                                        <th style="width: 10%;" ng-bind="resource('insured_by')"></th>
                                        <th style="width: 10%;" ng-bind="resource('insurer_by')"></th>
                                        <th style="width: 10%;" ng-bind="resource('sub_agency_commission_rate')"></th>
                                        <th style="width: 10%;" ng-bind="resource('sub_agency_commission')"></th>
                                        <th style="width: 3%;" ng-bind="resource('operation')"></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="p in policeListe">
                                        <td>
                                            <input type="checkbox" ng-model="checkboxes.items[p.Id]" />
                                        </td>
                                        <td><a href="#" editable-select="p.Tali.Kodu" e-ng-options="t.Kodu as t.Unvani for t in tvmler" onaftersave="updateRow(p,'T')" ng-bind="showTali(p)"></td>
                                        <td ng-bind="p.DisKaynakUnvani"></td>
                                        <td ng-bind="p.SigortaSirketi.Adi"></td>
                                        <td ng-bind="p.Brans.Adi"></td>
                                        <td ng-bind="p.Prim | number:2" class="price"></td>
                                        <td ng-bind="p.AlinanKomisyon | number:2" class="price"></td>
                                        <td ng-bind="p.PoliceTanzimTarihi|date:'dd/MM/yyyy'"></td>
                                        <td ng-bind="p.PoliceNo"></td>
                                        <td ng-bind="p.SigortaliUnvani"></td>
                                        <td ng-bind="p.SigortaEttirenUnvani"></td>
                                        <td><a href="#" editable-range="p.TaliKomisyonOrani" e-step="1" onaftersave="updateRow(p,'O')" ng-bind="p.TaliKomisyonOrani || '0'"></a></td>
                                        <td class="price"><a href="#" editable-number="p.TaliKomisyon" onaftersave="updateRow(p,'K')" e-max="{{p.AlinanKomisyon}}" e-step="any" ng-bind="p.TaliKomisyon | number:2"></a></td>
                                        <td><a id="search" class="btn green" ng-show="p.Guncelle" ng-click="postRow(p)" ng-bind="resource('update')"></a></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
