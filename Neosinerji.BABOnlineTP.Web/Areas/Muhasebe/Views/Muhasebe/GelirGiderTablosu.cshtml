@using Neosinerji.BABOnlineTP.Web.Content.Lang
@using Neosinerji.BABOnlineTP.Business.Muhasebe_CariHesap;


@model GelirGiderTablosuAnaModel

@section HorizontalMenu
{
    <ul class="nav">
        <li class="active">
            <a href="javascript:;">Gelir Gider Tablosu -İki Tarih Aralığı<span class="selected"></span></a>
        </li>

    </ul>
}
<head>
    <title>GelirGiderTablosu</title>
</head>

@section PageHeader
{
}

@section PageStyles
{
}

@section PageScripts
{
    @Scripts.Render("~/bundles/switch")>
    <link href="~/Content/css/bootstrapSwitch.min.css" rel="stylesheet" />
    <link href="~/Content/Angular/css/sweetalert.css" rel="stylesheet" />
    <link href="~/Content/css/bootstap-multiselect.css" rel="stylesheet" />
    <script src="~/Content/js/mask.js" type="text/javascript"></script>
    <script src="~/Content/Angular/js/sweetalert.min.js"></script>
    <script>

        $(document).ready(function () {

            $("#baslangicTarihi").mask("99.99.9999");
            $("#bitisTarihi").mask("99.99.9999");
            $("#baslangicTarihi").change(function () {
                BitisTarihiSetDate();
            });

            $("#bitisTarihi").change(function () {
                var dmy = $("#baslangicTarihi").val().split('.');
                var secilenTarih = dmy[2] + "-" + dmy[1] + "-" + dmy[0];
                var joindate = new Date(secilenTarih);
                var yil = joindate.getFullYear();

                var day = joindate.getDate();
                if (day < 10) {
                    day = "0" + day;
                }
                var ay = parseInt(joindate.getMonth()) + 2;
                if (ay < 10) {
                    ay = "0" + ay;
                }
                else if (ay > 12) {
                    ay = "0" + 1;
                    yil = yil + 1;
                }

                var bitisTarihi = yil + "-" + ay + "-" + day;
                var d1 = new Date(bitisTarihi);
                var bitT = $("#BitisTarih").val().split('.');
                var secilenbitT = bitT[2] + "-" + bitT[1] + "-" + bitT[0];
                var d2 = new Date(secilenbitT);
                var bitisTarihi2 = day + "." + ay + "." + yil;

                if (d2 > d1) {
                    $("#bitisTarihi").val(bitisTarihi2);
                    alert("Max değer değiştirilemez.");
                }
            });

            function BitisTarihiSetDate() {
                var dmy = $("#baslangicTarihi").val().split('.');
                var secilenTarih = dmy[2] + "-" + dmy[1] + "-" + dmy[0];
                var joindate = new Date(secilenTarih);
                var yil = joindate.getFullYear();

                var day = joindate.getDate();
                if (day < 10) {
                    day = "0" + day;
                }
                var ay = parseInt(joindate.getMonth()) + 2;
                if (ay < 10) {
                    ay = "0" + ay;
                }
                else if (ay > 12) {
                    ay = "0" + 1;
                    yil = yil + 1;
                }
                var bitisTarihi = day + "." + ay + "." + yil;
                $("#bitisTarihi").val(bitisTarihi);

                $("#bitisTarihi").datepicker("option", "maxDate", bitisTarihi);
                $("#bitisTarihi").datepicker("option", "minDate", joindate);
            }
     

            $('input[name="AramaTip"]').change(function () {
                var aramamTipi = $('input[name="AramaTip"]:checked').val();
                if (aramamTipi == 0) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
                else if (aramamTipi == 1) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
                else if (aramamTipi == 2) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
            });

            //Arama Yapıyor..
            $("#cariHesapAra").click(function () {
                $(this).button("loading");
                var carihesapadi = $("#CariHesapAdi").val();
                if (carihesapadi != null || carihesapadi != "") {
                    $.getJSON('/Muhasebe/Muhasebe/GetCariHesaplar', { hesapAdi: carihesapadi },
                        function (result) {
                            if (result.success) {
                                $("#CariHesapKodu").empty();
                                $("#CariHesapKodu").dropDownFill(result.list);
                                $("#cariHesapAra").button("reset");
                                $("#CariHesapKodu").focus();
                                $("#cariHesapVar").html(result.list.length + " tane hesap bulundu.");
                                $("#cariHesapVar").show();
                            }
                            else {
                                swal("Uyarı!", "Aranılan cari hesap bulunmadı.");
                                $("#CariHesapKodu").empty();
                                $("#CariHesapKodu").dropDownFill(result.list);
                                $("#CariHesapKodu").val("");
                                $("#cariHesapAra").button("reset");
                                $("#cariHesapVar").html("");
                                $("#cariHesapVar").hide();
                            }
                        });
                }
            });

            $(".btn-CariHareketSil").click(function () {

                var TVMKodu = $(this).attr("tvm-kodu");
                var id = $(this).attr("id-Kodu");
                var cariHesapKodu = $(this).attr("cari-Hesap-Kodu");
                var donem = $(this).attr("donem");
                var ay = $(this).attr("ay");
                var borc = $(this).attr("borc");
                var alacak = $(this).attr("alacak");

                $('#delete-confirm-btn').unbind('click');
                $("#delete-confirm-btn").click(function () {
                    $.post("/Muhasebe/Muhasebe/CariHesapHareketSil", {
                        tvmKodu: TVMKodu,
                        id: id,
                        cariHesapKodu: cariHesapKodu,
                        donem: donem,
                        ay: ay,
                        borc: borc,
                        alacak: alacak
                    },
                        function (check) {
                            if (check) {
                                $("#searchl").trigger("click");
                            };
                        });
                });
                $("#delete-confirmation").modal('show');

            });


            var oTable = $('#sample_1').dataTable({
                "bSort": false,
                "bPaginate": false,
                "bInfo": false,
                "bLengthChange": false,
                "sDom": 'T<"clear">lfrtip',
                "oTableTools": { "aButtons": ["pdf", "xls", "print", "copy"] }
            });
            var oTable = $('#sample_2').dataTable({
                "bSort": false,
                "bPaginate": false,
                "bInfo": false,
                "bLengthChange": false,
                "sDom": 'T<"clear">lfrtip',
                "oTableTools": { "aButtons": ["pdf", "xls", "print", "copy"] }
            });




            $("#searchl").click(function () {
                var aramamTipi = $('input[name="AramaTip"]:checked').val();
                if (aramamTipi == 0) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
                else if (aramamTipi == 1) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
                else if (aramamTipi == 2) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }


            });

            var aramamTipi = $('input[name="AramaTip"]:checked').val();

            if (aramamTipi == 0) {
                $("#BaslangicTarih").show();
                $("#BitisTarih").show();
                $("#baslangicTarihi").removeClass("ignore");
                $("#bitisTarihi").removeClass("ignore");
                $("#baslangicTarihi").attr("required", "required");
                $("#bitisTarihi").attr("required", "required");
                $("#CariHesapKod").hide();
                $("#MusteriGrupKod").hide();
                $("#Donemler").hide();
                $("#CariHesapKodu").addClass("ignore");
                $("#Donemler").addClass("ignore");
                $("#CariHesapAdi").addClass("ignore");
                $("#MusteriGurpKodu").addClass("ignore");
                $("#CariHesapKodu").removeAttr("required");
                $("#CariHesapAdi").removeAttr("required");
                $("#MusteriGurpKodu").removeAttr("required");
            }
            else if (aramamTipi == 1) {
                $("#BaslangicTarih").show();
                $("#BitisTarih").show();
                $("#baslangicTarihi").removeClass("ignore");
                $("#bitisTarihi").removeClass("ignore");
                $("#baslangicTarihi").attr("required", "required");
                $("#bitisTarihi").attr("required", "required");
                $("#CariHesapKod").hide();
                $("#MusteriGrupKod").hide();
                $("#Donemler").hide();
                $("#CariHesapKodu").addClass("ignore");
                $("#Donemler").addClass("ignore");
                $("#CariHesapAdi").addClass("ignore");
                $("#MusteriGurpKodu").addClass("ignore");
                $("#CariHesapKodu").removeAttr("required");
                $("#CariHesapAdi").removeAttr("required");
                $("#MusteriGurpKodu").removeAttr("required");
            }
            else if (aramamTipi == 2) {
                $("#BaslangicTarih").show();
                $("#BitisTarih").show();
                $("#baslangicTarihi").removeClass("ignore");
                $("#bitisTarihi").removeClass("ignore");
                $("#baslangicTarihi").attr("required", "required");
                $("#bitisTarihi").attr("required", "required");
                $("#CariHesapKod").hide();
                $("#MusteriGrupKod").hide();
                $("#Donemler").hide();
                $("#CariHesapKodu").addClass("ignore");
                $("#Donemler").addClass("ignore");
                $("#CariHesapAdi").addClass("ignore");
                $("#MusteriGurpKodu").addClass("ignore");
                $("#CariHesapKodu").removeAttr("required");
                $("#CariHesapAdi").removeAttr("required");
                $("#MusteriGurpKodu").removeAttr("required");
            }
        });
    </script>
}




<div class="row-fluid">
    <div class="span12">
        <div class="portlet box light-grey" style="margin-top: 25px;">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-reorder"></i>
                    <span class="hidden-480"> Gelir Gider Tablosu -İki Tarih Aralığı </span>
                </div>
            </div>
            <div class="portlet-body form">
                @using (Html.BeginForm("GelirGiderTablosu", "Muhasebe", FormMethod.Post, new { @class = "form-horizontal", id = "formGelirGiderTablosu", enctype = "multipart/form-data" }))
                {
                    <div class="row-fluid">
                        <div class="span8">
                            <div class="control-group">
                                <label class="control-label">Arama Tipi</label>
                                <div class="controls radio-custom">
                                    @Html.RadioButtonListFor(m => m.AramaTip, Model.AramaTipTipleri)
                                </div>
                            </div>

                            <div id="BaslangicTarih" style="display:none">
                                <div class="control-group">
                                    <div class="control-group">
                                        <label class="control-label">Başlangıç Tarihi <span class="required">*</span></label>
                                        <div class="controls">
                                            @Html.DateTextBoxFor(s => s.baslangicTarihi, new { style = "width:100px;", required = "required" })

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="BitisTarih" style="display:none">
                                <div class="control-group">
                                    <div class="control-group">
                                        <label class="control-label">Bitiş Tarihi <span class="required">*</span></label>
                                        <div class="controls">
                                            @Html.DateTextBoxFor(s => s.bitisTarihi, new { style = "width:100px;", required = "required" })
                                        </div>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                        </div>
                        <div class="form-actions">
                            <a href="~/Muhasebe/Muhasebe/GelirGiderTablosu" class="btn ligth-grey">@babonline.Clear</a>
                            <input type="submit" id="searchl" class="btn btn-success" data-loading-text="@babonline.QueryIndicator" value="@babonline.Search" />
                        </div>
                    </div>
                }

                <div class="row-fluid" style="margin-top: 20px;">
                    <div class="span12">
                        <div id="table-div" style="overflow-x: auto; margin-top: 15px;">
                            @if (Model.AramaTip == 0 || Model.AramaTip == 2)
                            {
                                <table class="table table-bordered table-hover dataTable data-table" id="sample_1" style="table-layout: inherit">
                                    <thead>
                                        @if (Model.dict.Count > 0)
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white; font-size:20px;">@Model.baslangicTarihi.ToShortDateString()-@Model.bitisTarihi.ToShortDateString()</th>
                                                <th style="width: auto; border-color :white; font-size:18px; text-align:center;">Gelir Tablosu</th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: 10%; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;"> </th>
                                            </tr>
                                        }

                                    </thead>
                                    <tbody>
                                        <tr style="background-color:#99CCFF !important;">
                                            <th style="width: auto;"> Cari Hesap Kodu</th>
                                            <th style="width: auto;"> Hesap Adı</th>
                                            <th style="width: auto;"> Para Brm. </th>
                                            <th style="width: auto;"> Borç      </th>
                                            <th style="width: auto;"> Alacak    </th>
                                            <th style="width: auto;"> Bakiye   </th>
                                            <th style="width: auto;"> B/A  </th>
                                        </tr>
                                        @if (Model.dict.Count > 0)
                                        {
                                            foreach (var cariHesap in Model.dict)
                                            {
                                                decimal? toplamBakiye = 0;


                                                if (cariHesap.Value.list != null && cariHesap.Value.list.Count > 0)
                                                {
                                                    foreach (var item in cariHesap.Value.list)
                                                    {
                                                        decimal? bakiye = item.Borc.Value - item.Alacak.Value;
                                                        toplamBakiye += bakiye;
                                                    }
                                                    List<string> giderTipList = new List<string>
                                                                                                                                                                                                                                                                                                    {
                                                            "103",
                                                            "330",
                                                            "610",
                                                            "611",
                                                            "612",
                                                            "740",
                                                    };
                                                    if (!giderTipList.Contains(cariHesap.Key.Substring(0, 3)))
                                                    {
                                                        <tr>

                                                            <td style="width: 21%;">@cariHesap.Key</td>

                                                            <td style="width: 25%;">@cariHesap.Value.CariHesapAdi </td>
                                                            <td style="width: 6%;">@cariHesap.Value.paraBirimi</td>
                                                            @if (cariHesap.Value.BorcToplam.HasValue)
                                                            {
                                                                <td style="text-align: right;">@cariHesap.Value.BorcToplam.Value.ToString("N") </td>
                                                            }
                                                            else
                                                            {
                                                                <td></td>
                                                            }
                                                            @if (cariHesap.Value.AlacakToplam.HasValue)
                                                            {
                                                                <td style="text-align: right;">@cariHesap.Value.AlacakToplam.Value.ToString("N") </td>
                                                            }
                                                            else
                                                            {
                                                                <td></td>
                                                            }
                                                            @if (toplamBakiye < 0)
                                                            {
                                                                toplamBakiye = toplamBakiye * -1;
                                                                <td style="text-align: right;">@toplamBakiye.Value.ToString("N") </td>
                                                                toplamBakiye = toplamBakiye * -1;
                                                            }
                                                            else
                                                            {
                                                                <td style="text-align: right;">@toplamBakiye.Value.ToString("N") </td>
                                                            }

                                                            @if (toplamBakiye < 0)
                                                            {
                                                                <td style="width: 5%; text-align: center;">A</td>
                                                            }
                                                            else
                                                            {
                                                                <td style="width: 5%; text-align: center;">B</td>
                                                            }
                                                        </tr>
                                                    }

                                                }
                                            }


                                            if (Model.AramaTip == 0)
                                            {
                                                <tr class="odd">
                                                    <td class=" "><b>Genel Toplam </b></td>
                                                    <td class=" "></td>
                                                    <td class=" "></td>
                                                    @{decimal genelBorcToplam = Model.dict.Sum(x => x.Value.BorcToplam) ?? 0;}
                                                    @{decimal genelAlacakToplam = Model.dict.Sum(x => x.Value.AlacakToplam) ?? 0;}
                                                    @{decimal genelBakiyeToplam = Model.dict.Sum(x => x.Value.BakiyeToplam) ?? 0;}

                                                    <td style="text-align: right;" class=" "><b>@genelBorcToplam.ToString("N") </b></td>
                                                    <td style="text-align: right;" class=" "><b>@genelAlacakToplam.ToString("N")</b></td>
                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        genelBakiyeToplam = genelBakiyeToplam * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>

                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>
                                                    }

                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>A</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>B</b></td>
                                                    }
                                                </tr>

                                            }
                                            else
                                            {
                                                <tr class="odd">
                                                    <td class=" "><b>Genel Toplam </b></td>
                                                    <td class=" "></td>
                                                    <td class=" "></td>
                                                    @{decimal genelBorcToplam = Model.dict.Sum(x => x.Value.BorcToplam) ?? 0;}
                                                    @{decimal genelAlacakToplam = Model.dict.Sum(x => x.Value.AlacakToplam) ?? 0;}
                                                    @{decimal genelBakiyeToplam = Model.dict.Sum(x => x.Value.BakiyeToplam) ?? 0;}

                                                    <td style="text-align: right;" class=" "><b>@genelBorcToplam.ToString("N") </b></td>
                                                    <td style="text-align: right;" class=" "><b>@genelAlacakToplam.ToString("N")</b></td>
                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        genelBakiyeToplam = genelBakiyeToplam * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>

                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>
                                                    }

                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>A</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>B</b></td>
                                                    }
                                                </tr>

                                            }
                                        }
                                    </tbody>
                                </table>
                            }
                            @if (Model.AramaTip == 1 || Model.AramaTip == 2)
                            {
                                <table class="table table-bordered table-hover dataTable data-table" id="sample_2" style="table-layout: inherit">
                                    <thead>
                                        @if (Model.dict.Count > 0)
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">

                                                <th style="width: auto; border-color :white; font-size:20px;">@Model.baslangicTarihi.ToShortDateString()-@Model.bitisTarihi.ToShortDateString()</th>
                                                <th style="width: auto; border-color :white; font-size:18px; text-align:center;">Gider Tablosu</th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: 10%; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;"> </th>
                                            </tr>
                                        }
                                    </thead>
                                    <tbody>
                                        <tr style="background-color:#99CCFF !important;">
                                            <th style="width: auto;"> Cari Hesap Kodu</th>
                                            <th style="width: auto;"> Hesap Adı</th>
                                            <th style="width: auto;"> Para Brm. </th>
                                            <th style="width: auto;"> Borç      </th>
                                            <th style="width: auto;"> Alacak    </th>
                                            <th style="width: auto;"> Bakiye   </th>
                                            <th style="width: auto;"> B/A  </th>
                                        </tr>
                                        @if (Model.dict.Count > 0)
                                        {
                                            foreach (var cariHesap in Model.dict)
                                            {
                                                decimal? toplamBakiye = 0;


                                                if (cariHesap.Value.list != null && cariHesap.Value.list.Count > 0)
                                                {

                                                    foreach (var item in cariHesap.Value.list)
                                                    {

                                                        decimal? bakiye = item.Borc.Value - item.Alacak.Value;
                                                        toplamBakiye += bakiye;

                                                    }
                                                    List<string> gelirTipList = new List<string>
                                                                                                                                                                                                                                                                                                                                                                                {
                                                            "101",
                                                            "600",
                                                            "602"
                                                        };
                                                    if (!gelirTipList.Contains(cariHesap.Key.Substring(0, 3)))
                                                    {
                                                        if (Model.AramaTip == 1)
                                                        {
                                                            <tr>
                                                                <td style="width: 21%;">@cariHesap.Key</td>
                                                                <td style="width: 25%;">@cariHesap.Value.CariHesapAdi </td>
                                                                <td style="width: 6%;">@cariHesap.Value.paraBirimi</td>
                                                                @if (cariHesap.Value.BorcToplam.HasValue)
                                                                {
                                                                    <td style="text-align: right;">@cariHesap.Value.BorcToplam.Value.ToString("N") </td>
                                                                }
                                                                else
                                                                {
                                                                    <td></td>
                                                                }
                                                                @if (cariHesap.Value.AlacakToplam.HasValue)
                                                                {
                                                                    <td style="text-align: right;">@cariHesap.Value.AlacakToplam.Value.ToString("N") </td>
                                                                }
                                                                else
                                                                {
                                                                    <td></td>
                                                                }
                                                                @if (toplamBakiye < 0)
                                                                {
                                                                    toplamBakiye = toplamBakiye * -1;
                                                                    <td style="text-align: right;">@toplamBakiye.Value.ToString("N") </td>
                                                                    toplamBakiye = toplamBakiye * -1;
                                                                }
                                                                else
                                                                {
                                                                    <td style="text-align: right;">@toplamBakiye.Value.ToString("N") </td>
                                                                }
                                                                @if (toplamBakiye < 0)
                                                                {
                                                                    <td style="width: 5%; text-align: center;">A</td>
                                                                }
                                                                else
                                                                {
                                                                    <td style="width: 5%; text-align: center;">B</td>
                                                                }
                                                            </tr>

                                                        }
                                                        else
                                                        {
                                                            <tr>
                                                                <td style="width: 21%;">@cariHesap.Key</td>
                                                                <td style="width: 25%;">@cariHesap.Value.CariHesapAdi </td>
                                                                <td style="width: 6%;">@cariHesap.Value.paraBirimi</td>
                                                                @if (cariHesap.Value.BorcToplamHer.HasValue)
                                                                {
                                                                    <td style="text-align: right;">@cariHesap.Value.BorcToplamHer.Value.ToString("N") </td>
                                                                }
                                                                else
                                                                {
                                                                    <td></td>
                                                                }
                                                                @if (cariHesap.Value.AlacakToplamHer.HasValue)
                                                                {
                                                                    <td style="text-align: right;">@cariHesap.Value.AlacakToplamHer.Value.ToString("N") </td>
                                                                }
                                                                else
                                                                {
                                                                    <td></td>
                                                                }
                                                                @if (toplamBakiye < 0)
                                                                {
                                                                    toplamBakiye = toplamBakiye * -1;
                                                                    <td style="text-align: right;">@toplamBakiye.Value.ToString("N") </td>
                                                                    toplamBakiye = toplamBakiye * -1;
                                                                }
                                                                else
                                                                {
                                                                    <td style="text-align: right;">@toplamBakiye.Value.ToString("N") </td>
                                                                }
                                                                @if (toplamBakiye < 0)
                                                                {
                                                                    <td style="width: 5%; text-align: center;">A</td>
                                                                }
                                                                else
                                                                {
                                                                    <td style="width: 5%; text-align: center;">B</td>
                                                                }
                                                            </tr>

                                                        }
                                                    }

                                                }
                                            }
                                            if (Model.AramaTip == 1)
                                            {
                                                <tr class="odd">
                                                    <td class=" "><b>Genel Toplam </b></td>
                                                    <td class=" "></td>
                                                    <td class=" "></td>
                                                    @{decimal genelBorcToplam = Model.dict.Sum(x => x.Value.BorcToplam) ?? 0;}
                                                    @{decimal genelAlacakToplam = Model.dict.Sum(x => x.Value.AlacakToplam) ?? 0;}
                                                    @{decimal genelBakiyeToplam = Model.dict.Sum(x => x.Value.BakiyeToplam) ?? 0;}
                                                    <td style="text-align: right;" class=" "><b>@genelBorcToplam.ToString("N") </b></td>
                                                    <td style="text-align: right;" class=" "><b>@genelAlacakToplam.ToString("N")</b></td>
                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        genelBakiyeToplam = genelBakiyeToplam * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>
                                                    }
                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>A</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>B</b></td>
                                                    }
                                                </tr>

                                            }
                                            else
                                            {
                                                <tr class="odd">
                                                    <td class=" "><b>Genel Toplam </b></td>
                                                    <td class=" "></td>
                                                    <td class=" "></td>
                                                    @{decimal genelBorcToplam = Model.dict.Sum(x => x.Value.BorcToplamHer) ?? 0;}
                                                    @{decimal genelAlacakToplam = Model.dict.Sum(x => x.Value.AlacakToplamHer) ?? 0;}
                                                    @{decimal genelBakiyeToplam = Model.dict.Sum(x => x.Value.BakiyeToplamHer) ?? 0;}
                                                    <td style="text-align: right;" class=" "><b>@genelBorcToplam.ToString("N") </b></td>
                                                    <td style="text-align: right;" class=" "><b>@genelAlacakToplam.ToString("N")</b></td>
                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        genelBakiyeToplam = genelBakiyeToplam * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelBakiyeToplam.ToString("N")</b></td>
                                                    }
                                                    @if (genelBakiyeToplam < 0)
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>A</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>B</b></td>
                                                    }
                                                </tr>

                                            }



                                            if (Model.AramaTip == 2)
                                            {
                                                <tr class="odd">
                                                    @{  decimal genelBorcToplamHer = Model.dict.Sum(x => x.Value.BorcToplamHer) ?? 0;
                                                        decimal genelAlacakToplamHer = Model.dict.Sum(x => x.Value.AlacakToplamHer) ?? 0;
                                                        decimal genelBakiyeToplamHer = Model.dict.Sum(x => x.Value.BakiyeToplamHer) ?? 0;

                                                        decimal genelBorcToplamGelir = Model.dict.Sum(x => x.Value.BorcToplam) ?? 0;
                                                        decimal genelAlacakToplamGelir = Model.dict.Sum(x => x.Value.AlacakToplam) ?? 0;
                                                        decimal genelBakiyeToplamGelir = Model.dict.Sum(x => x.Value.BakiyeToplam) ?? 0;
                                                        if( genelBakiyeToplamHer < 0)
                                                        {
                                                            genelBakiyeToplamHer = genelBakiyeToplamHer * -1;
                                                        }
                                                        if(genelBorcToplamHer < 0)
                                                        {
                                                            genelBorcToplamHer = genelBorcToplamHer * -1;
                                                        }
                                                        if(genelAlacakToplamHer < 0)
                                                        {
                                                            genelAlacakToplamHer = genelAlacakToplamHer * -1;
                                                        }

                                                        if(genelBorcToplamGelir < 0)
                                                        {
                                                            genelBorcToplamGelir = genelBorcToplamGelir * -1;
                                                        }
                                                        if(genelAlacakToplamGelir < 0)
                                                        {
                                                            genelAlacakToplamGelir = genelAlacakToplamGelir * -1;
                                                        }
                                                        if(genelBakiyeToplamGelir < 0)
                                                        {
                                                            genelBakiyeToplamGelir = genelBakiyeToplamGelir * -1;
                                                        }

                                                        var genelBorc =  genelBorcToplamHer-genelBorcToplamGelir;
                                                        var genelAlacak = genelAlacakToplamHer-genelAlacakToplamGelir;
                                                        var genelBakiye = genelBakiyeToplamHer-genelBakiyeToplamGelir;
                                                    }
                                                    <td style=" font-size:15px"><b>Gelir Gider Fark Toplamı  </b></td>
                                                    <td class=" "></td>
                                                    <td class=" "></td>
                                                    @if (genelBorc < 0)
                                                    {
                                                        genelBorc = genelBorc * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelBorc.ToString("N") </b></td>

                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelBorc.ToString("N") </b></td>

                                                    }
                                                    @if (genelAlacak < 0)
                                                    {
                                                        genelAlacak = genelAlacak * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelAlacak.ToString("N")</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelAlacak.ToString("N")</b></td>
                                                    }
                                                    @if (genelBakiye< 0)
                                                    {
                                                        genelBakiye = genelBakiye * -1;
                                                        <td style="text-align: right;" class=" "><b>@genelBakiye.ToString("N")</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="text-align: right;" class=" "><b>@genelBakiye.ToString("N")</b></td>
                                                    }
                                                    @if (genelBakiye < 0)
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>A</b></td>
                                                    }
                                                    else
                                                    {
                                                        <td style="width: 5%; text-align: center;"><b>B</b></td>
                                                    }
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*Silme İşlemi*@
@Html.Partial("_DeleteConfirmation")