@using Neosinerji.BABOnlineTP.Web.Content.Lang
@using Neosinerji.BABOnlineTP.Web.Areas.Muhasebe.Models
@using Neosinerji.BABOnlineTP.Database.Models
@using menu = Neosinerji.BABOnlineTP.Business.Common

@model CariHesapHareketKontrolListesiModel

@section HorizontalMenu
{
    <ul class="nav">
        <li class="active">
            <a href="javascript:;"> @babonline.CurrentAccountTransactionChecklist<span class="selected"></span></a>
        </li>

    </ul>
}
<head>
    <title>@babonline.CurrentAccountTransactionChecklist</title>
</head>

@section PageHeader
{
}

@section PageStyles
{

}

@section PageScripts
{
    @Scripts.Render("~/bundles/switch")>
    <link href="~/Content/css/bootstrapSwitch.min.css" rel="stylesheet" />
    <link href="~/Content/Angular/css/sweetalert.css" rel="stylesheet" />
    <link href="~/Content/css/bootstap-multiselect.css" rel="stylesheet" />
    <script src="~/Content/Angular/js/sweetalert.min.js"></script>
    <script>

        $(document).ready(function () {

            $('input[name="AramaTip"]').change(function () {
                var aramamTipi = $('input[name="AramaTip"]:checked').val();
                if (aramamTipi == 0) {
                    $("#CariHesapKod").show();
                    $("#Donemler").show();
                    $("#MusteriGrupKod").hide();
                    $("#BaslangicTarih").hide();
                    $("#BitisTarih").hide();
                    $("#CariHesapKodu").removeClass("ignore");
                    $("#Donemler").removeClass("ignore");
                    $("#CariHesapAdi").removeClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#baslangicTarihi").addClass("ignore");
                    $("#bitisTarihi").addClass("ignore");
                    $("#CariHesapKodu").attr("required", "required");
                    $("#CariHesapAdi").attr("required", "required");
                    $("#MusteriGurpKodu").removeAttr("required");
                    $("#baslangicTarihi").removeAttr("required");
                    $("#bitisTarihi").removeAttr("required");
                }
                else if (aramamTipi == 1) {
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").show();
                    $("#Donemler").show();
                    $("#BaslangicTarih").hide();
                    $("#BitisTarih").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").removeClass("ignore");
                    $("#Donemler").removeClass("ignore");
                    $("#baslangicTarihi").addClass("ignore");
                    $("#bitisTarihi").addClass("ignore");
                    $("#baslangicTarihi").removeAttr("required");
                    $("#bitisTarihi").removeAttr("required");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").attr("required", "required");
                }
                else if (aramamTipi == 2) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
            });
            //Arama Yapıyor..
            $("#cariHesapAra").click(function () {
                $(this).button("loading");
                var carihesapadi = $("#CariHesapAdi").val();
                if (carihesapadi != null || carihesapadi != "") {
                    $.getJSON('/Muhasebe/Muhasebe/GetCariHesaplar', { hesapAdi: carihesapadi },
                        function (result) {
                            if (result.success) {
                                $("#CariHesapKodu").empty();
                                $("#CariHesapKodu").dropDownFill(result.list);
                                $("#cariHesapAra").button("reset");
                                $("#CariHesapKodu").focus();
                                $("#cariHesapVar").html(result.list.length + " @babonline.AccountsFound.");
                                $("#cariHesapVar").show();
                            }
                            else {
                                swal("@babonline.Warning!", "@babonline.CurrentAccountNotFound.");
                                $("#CariHesapKodu").empty();
                                $("#CariHesapKodu").dropDownFill(result.list);
                                $("#CariHesapKodu").val("");
                                $("#cariHesapAra").button("reset");
                                $("#cariHesapVar").html("");
                                $("#cariHesapVar").hide();
                            }
                        });
                }
            });

            $(".btn-CariHareketSil").click(function () {

                var TVMKodu = $(this).attr("tvm-kodu");
                var id = $(this).attr("id-Kodu");
                var cariHesapKodu = $(this).attr("cari-Hesap-Kodu");
                var donem = $(this).attr("donem");
                var ay = $(this).attr("ay");
                var borc = $(this).attr("borc");
                var alacak = $(this).attr("alacak");

                $('#delete-confirm-btn').unbind('click');
                $("#delete-confirm-btn").click(function () {
                    $.post("/Muhasebe/Muhasebe/CariHesapHareketSil", {
                        tvmKodu: TVMKodu,
                        id: id,
                        cariHesapKodu: cariHesapKodu,
                        donem: donem,
                        ay: ay,
                        borc: borc,
                        alacak: alacak
                    },
                        function (check) {
                            if (check) {
                                $("#searchl").trigger("click");
                            };
                        });
                });
                $("#delete-confirmation").modal('show');

            });


            var oTable = $('#sample_1').dataTable({
                "bSort": false,
                "bPaginate": false,
                "bInfo": false,
                "bLengthChange": false,
                "sDom": 'T<"clear">lfrtip',
                "oTableTools": { "aButtons": ["pdf", "xls", "print", "copy"] }
            });
            $("#searchl").click(function () {
                var aramamTipi = $('input[name="AramaTip"]:checked').val();
                if (aramamTipi == 0) {
                    $("#CariHesapKod").show();
                    $("#Donemler").show();
                    $("#MusteriGrupKod").hide();
                    $("#BaslangicTarih").hide();
                    $("#BitisTarih").hide();
                    $("#CariHesapKodu").removeClass("ignore");
                    $("#Donemler").removeClass("ignore");
                    $("#CariHesapAdi").removeClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#baslangicTarihi").addClass("ignore");
                    $("#bitisTarihi").addClass("ignore");
                    $("#CariHesapKodu").attr("required", "required");
                    $("#CariHesapAdi").attr("required", "required");
                    $("#MusteriGurpKodu").removeAttr("required");
                    $("#baslangicTarihi").removeAttr("required");
                    $("#bitisTarihi").removeAttr("required");
                }
                else if (aramamTipi == 1) {
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").show();
                    $("#Donemler").show();
                    $("#BaslangicTarih").hide();
                    $("#BitisTarih").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").removeClass("ignore");
                    $("#Donemler").removeClass("ignore");
                    $("#baslangicTarihi").addClass("ignore");
                    $("#bitisTarihi").addClass("ignore");
                    $("#baslangicTarihi").removeAttr("required");
                    $("#bitisTarihi").removeAttr("required");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").attr("required", "required");
                }
                else if (aramamTipi == 2) {
                    $("#BaslangicTarih").show();
                    $("#BitisTarih").show();
                    $("#baslangicTarihi").removeClass("ignore");
                    $("#bitisTarihi").removeClass("ignore");
                    $("#baslangicTarihi").attr("required", "required");
                    $("#bitisTarihi").attr("required", "required");
                    $("#CariHesapKod").hide();
                    $("#MusteriGrupKod").hide();
                    $("#Donemler").hide();
                    $("#CariHesapKodu").addClass("ignore");
                    $("#Donemler").addClass("ignore");
                    $("#CariHesapAdi").addClass("ignore");
                    $("#MusteriGurpKodu").addClass("ignore");
                    $("#CariHesapKodu").removeAttr("required");
                    $("#CariHesapAdi").removeAttr("required");
                    $("#MusteriGurpKodu").removeAttr("required");
                }
            });

            var aramamTipi = $('input[name="AramaTip"]:checked').val();

            if (aramamTipi == 0) {
                $("#CariHesapKod").show();
                $("#Donemler").show();
                $("#MusteriGrupKod").hide();
                $("#BaslangicTarih").hide();
                $("#BitisTarih").hide();
                $("#CariHesapKodu").removeClass("ignore");
                $("#Donemler").removeClass("ignore");
                $("#CariHesapAdi").removeClass("ignore");
                $("#MusteriGurpKodu").addClass("ignore");
                $("#baslangicTarihi").addClass("ignore");
                $("#bitisTarihi").addClass("ignore");
                $("#CariHesapKodu").attr("required", "required");
                $("#CariHesapAdi").attr("required", "required");
                $("#MusteriGurpKodu").removeAttr("required");
                $("#baslangicTarihi").removeAttr("required");
                $("#bitisTarihi").removeAttr("required");
            }
            else if (aramamTipi == 1) {
                $("#CariHesapKod").hide();
                $("#MusteriGrupKod").show();
                $("#Donemler").show();
                $("#BaslangicTarih").hide();
                $("#BitisTarih").hide();
                $("#CariHesapKodu").addClass("ignore");
                $("#CariHesapAdi").addClass("ignore");
                $("#MusteriGurpKodu").removeClass("ignore");
                $("#Donemler").removeClass("ignore");
                $("#baslangicTarihi").addClass("ignore");
                $("#bitisTarihi").addClass("ignore");
                $("#baslangicTarihi").removeAttr("required");
                $("#bitisTarihi").removeAttr("required");
                $("#CariHesapKodu").removeAttr("required");
                $("#CariHesapAdi").removeAttr("required");
                $("#MusteriGurpKodu").attr("required", "required");
            }
            else if (aramamTipi == 2) {
                $("#BaslangicTarih").show();
                $("#BitisTarih").show();
                $("#baslangicTarihi").removeClass("ignore");
                $("#bitisTarihi").removeClass("ignore");
                $("#baslangicTarihi").attr("required", "required");
                $("#bitisTarihi").attr("required", "required");
                $("#CariHesapKod").hide();
                $("#MusteriGrupKod").hide();
                $("#Donemler").hide();
                $("#CariHesapKodu").addClass("ignore");
                $("#Donemler").addClass("ignore");
                $("#CariHesapAdi").addClass("ignore");
                $("#MusteriGurpKodu").addClass("ignore");
                $("#CariHesapKodu").removeAttr("required");
                $("#CariHesapAdi").removeAttr("required");
                $("#MusteriGurpKodu").removeAttr("required");
            }
        });
    </script>
}




<div class="row-fluid">
    <div class="span12">
        <div class="portlet box light-grey" style="margin-top: 25px;">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-reorder"></i>
                    <span class="hidden-480"> @babonline.CurrentAccountTransactionChecklist </span>
                </div>
            </div>
            <div class="portlet-body form">
                @using (Html.BeginForm("CariHesapHareketKontrolListesi", "Muhasebe", FormMethod.Post, new { @class = "form-horizontal", id = "formCariHesapHareketKontrolListesi", enctype = "multipart/form-data" }))
                {
                    <div class="row-fluid">
                        <div class="span8">
                            <div class="control-group">
                                <label class="control-label">@babonline.SearchType</label>
                                <div class="controls radio-custom">
                                    @Html.RadioButtonListFor(m => m.AramaTip, Model.AramaTipTipleri)
                                </div>
                            </div>
                            <div id="CariHesapKod" style="display:none">
                                <div class="control-group">
                                    <label class="control-label">@babonline.SearchCurrentAccount<span class="required">*</span></label>
                                    <div class="controls">
                                        @Html.TextBoxFor(s => s.CariHesapAdi, new { minlength = 3, maxlength = 30, style = "width:50%", required = "required", placeHolder = babonline.EnterCurrentAccountName })
                                        @Html.ValidationMessageFor(m => m.CariHesapAdi)
                                        <button class="btn btn-info " id="cariHesapAra" type="button" data-loading-text="@babonline.Searching">@babonline.Search</button><br />

                                    </div>
                                </div>
                                <div class="control-group" id="CariHesapSecimi" style="">
                                    <label class="control-label">@babonline.CurrentAccount<span class="required">*</span></label>
                                    <div class="controls">
                                        @Html.DropDownListFor(s => s.CariHesapKodu, Model.CariHesapList, new { style = "width:50%", required = "required" })<span style="color:red;display:none;" id="cariHesapVar"></span>
                                        @Html.ValidationMessageFor(m => m.CariHesapKodu)
                                    </div>
                                </div>
                            </div>
                            <div id="MusteriGrupKod" style="display:none">
                                <div class="control-group">
                                    <label class="control-label">@babonline.CustomerGroupName<span class="required">*</span></label>
                                    <div class="controls">
                                        @Html.TextBoxFor(s => s.MusteriGurpKodu, new { minlength = 3, maxlength = 30, style = "width:50%", placeHolder = @babonline.EnterCustomerGroupNameOrCode, required = "required" })
                                        @Html.ValidationMessageFor(m => m.MusteriGurpKodu)

                                    </div>
                                </div>
                            </div>
                            <div id="BaslangicTarih" style="display:none">
                                <div class="control-group">
                                    <div class="control-group">
                                        <label class="control-label">@babonline.StartDate <span class="required">*</span></label>
                                        <div class="controls">
                                            @Html.DateTextBoxFor(s => s.baslangicTarihi, new { style = "width:100px;", required = "required" })
                                            @*@Html.ValidationMessageFor(m => m.baslangicTarihi)*@
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="BitisTarih" style="display:none">
                                <div class="control-group">
                                    <div class="control-group">
                                        <label class="control-label">@babonline.EndDate <span class="required">*</span></label>
                                        <div class="controls">
                                            @Html.DateTextBoxFor(s => s.bitisTarihi, new { style = "width:100px;", required = "required" })
                                            @*@Html.ValidationMessageFor(m => m.bitisTarihi)*@
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="Donemler" style="display:none">
                                <div class="control-group">
                                    <label class="control-label">@babonline.Period</label>
                                    <div class="controls">
                                        @Html.DropDownListFor(s => s.Donem, Model.Donemler, new { style = "width:125px" })
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4">
                        </div>
                        <div class="form-actions">
                            <a href="~/Muhasebe/Muhasebe/CariHesapHareketKontrolListesi" class="btn ligth-grey">@babonline.Clear</a>
                            <input type="submit" id="searchl" class="btn btn-success" data-loading-text="@babonline.QueryIndicator" value="@babonline.Search" />
                        </div>
                    </div>
                }

                <div class="row-fluid" style="margin-top: 20px;">
                    <div class="span12">
                        <div id="table-div" style="overflow-x: auto; margin-top: 15px;">
                            @*arama durumu true ise ada göre arıyor. false ise başlangıç bitiş tarihleri arası arıyor*@
                            @if (ViewBag.AnaTVM && Model.AramaDurumu)
                            {
                                <table class="table table-bordered table-hover dataTable data-table" id="sample_1" style="table-layout: inherit">
                                    <thead>
                                        @if (Model.BorcToplam.HasValue)
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white; ">@babonline.Period - @Model.Donem</th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>


                                                <th style="width: auto; border-color :white;font-size:20px;">@babonline.CurrentAccountTransactionChecklist </th>
                                                @if (Model.AramaTip == 0)
                                                {
                                                    <th style="width: 10%; border-color :white;">@Model.CariHesapText </th>
                                                }
                                                else if (Model.AramaTip == 1)
                                                {
                                                    <th style="width: 10%; border-color :white;"> @Model.MusteriGurpKodu  </th>
                                                }
                                                else
                                                {
                                                    <th style="width: 10%; border-color :white;">  </th>
                                                }
                                                <th style="width: auto; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: 10%; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                            </tr>
                                        }
                                    </thead>
                                    <tbody>
                                        <tr id="baslikRow" style="background-color:#99CCFF !important;">
                                            <th style="width: auto;"> @babonline._expiryDate</th>
                                            <th style="width: auto;"> @babonline._documentDate</th>
                                            <th style="width: auto;"> @babonline._documentType</th>
                                            <th style="width: auto;"> @babonline._paymentType</th>
                                            <th style="width: auto;"> @babonline._documentNo </th>
                                            <th style="width: 10%;"> Ack.  </th>
                                            <th style="width: auto;"> @babonline._currency</th>
                                            <th style="width: auto;"> @babonline.Debt      </th>
                                            <th style="width: auto;"> @babonline.Receivables    </th>
                                            <th style="width: auto;"> @babonline.Balance   </th>
                                            <th style="width: auto;"> B/A  </th>
                                            <th style="width: auto;">@babonline.Delete</th>

                                        </tr>
                                        @{ decimal? toplamBakiye = 0;}
                                        @if (Model.list != null && Model.list.Count > 0)
                                        {

                                            foreach (var item in Model.list)
                                            {
                                                if (item.BorcTipi == "A")
                                                {
                                                    <tr style="color:#d70000">
                                                        <td style="width: 4%;">@item.VadeTarihi.ToString("dd.MM.yyyy")</td>
                                                        @if (item.OdemeTarihi.HasValue)
                                                        {
                                                            <td style="width: 4%;">@item.OdemeTarihi.Value.ToString("dd.MM.yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 4%;"></td>
                                                        }
                                                        <td style="width: 6%;">@item.EvrakTipi</td>
                                                        <td style="width: 5%;">@item.OdemeTipi</td>
                                                        <td style="width: 5%;">@item.EvrakNo   </td>
                                                        <td style="width: 10%"> @item.Aciklama  </td>
                                                        <td style="width: 3%; text-align: center;"> @item.ParaBirimi  </td>
                                                        <td style="width: 5%; text-align: right;">@item.Borc.Value.ToString("N")      </td>
                                                        <td style="width: 5%; text-align: right;"> @item.Alacak.Value.ToString("N")    </td>
                                                        @{
                                                            decimal? bakiye = item.Borc.Value - item.Alacak.Value;
                                                            toplamBakiye += bakiye;
                                                        }
                                                        <td style="width: 5%;text-align: right;"> @toplamBakiye.Value.ToString("N")  </td>
                                                        @if (@bakiye < 0)
                                                        {
                                                            <td style="width: 3%; text-align: center;">A</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 3%; text-align: center;">B</td>
                                                        }



                                                        <td style="width: 3%; max-width: 7px">
                                                            @{
                                                                var odemeTarihiMonth = item.OdemeTarihi.HasValue ? item.OdemeTarihi.Value.Month.ToString() : "";
                                                                var odemeTarihiYear = item.OdemeTarihi.HasValue ? item.OdemeTarihi.Value.Year.ToString() : "";
                                                            }

                                                            <a class="btn btn-mini btn-CariHareketSil" href="javascript:void(0)" id="btnCariHareketSil" id-Kodu=@item.id cari-Hesap-Kodu=@item.CariHesapKodu tvm-kodu="@ViewBag.TVMKodu" donem="@odemeTarihiYear" ay="@odemeTarihiMonth" borc="@item.Borc" alacak="@item.Alacak" rel="tooltip" data-placement="bottom" data-original-title="@babonline.Delete">
                                                                <i class="icon-remove"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                }
                                                else
                                                {
                                                    var odemeTarihiMonth = item.OdemeTarihi.HasValue ? item.OdemeTarihi.Value.Month.ToString() : "";
                                                    var odemeTarihiYear = item.OdemeTarihi.HasValue ? item.OdemeTarihi.Value.Year.ToString() : "";
                                                    <tr>
                                                        <td style="width: 6%;">@item.VadeTarihi.ToString("dd.MM.yyyy")</td>
                                                        @if (item.OdemeTarihi.HasValue)
                                                        {
                                                            <td style="width: 6%;">@item.OdemeTarihi.Value.ToString("dd.MM.yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 6%;"></td>
                                                        }
                                                        <td style="width: 6%;">@item.EvrakTipi</td>
                                                        <td style="width: 5%;">@item.OdemeTipi</td>
                                                        <td style="width: 5%;">@item.EvrakNo   </td>
                                                        <td style="width: 10%"> @item.Aciklama  </td>
                                                        <td style="width: 3%; text-align: center;"> @item.ParaBirimi  </td>
                                                        <td style="width: 5%; text-align: right;">@item.Borc.Value.ToString("N")      </td>
                                                        @if (item.Alacak.HasValue)
                                                        {
                                                            <td style="width: 5%; text-align: right;"> @item.Alacak.Value.ToString("N")    </td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 5%;"></td>
                                                        }
                                                        @{
                                                            decimal? bakiye = item.Borc.Value - item.Alacak.Value;
                                                            toplamBakiye += bakiye;

                                                        }
                                                        <td style="width: 5%; text-align: right;"> @toplamBakiye.Value.ToString("N")  </td>

                                                        @if (@bakiye < 0)
                                                        {
                                                            <td style="width: 3%;text-align: center;">A</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 3%;text-align: center;">B</td>
                                                        }
                                                        <td style="width: 3%;  max-width: 7px">
                                                            <a class="btn btn-mini btn-CariHareketSil" href="javascript:void(0)" id="btnCariHareketSil" id-Kodu=@item.id cari-Hesap-Kodu=@item.CariHesapKodu tvm-kodu="@ViewBag.TVMKodu" donem="@odemeTarihiYear" ay="@odemeTarihiMonth" borc="@item.Borc" alacak="@item.Alacak" rel="tooltip" data-placement="bottom" data-original-title="Sil">
                                                                <i class="icon-remove"></i>
                                                            </a>
                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            <tr>
                                                <td><b>@babonline.OverallTotal</b></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                @if (Model.BorcToplam.HasValue)
                                                {
                                                    <td style="text-align: right;"><b>@Model.BorcToplam.Value.ToString("N") </b></td>
                                                }
                                                else
                                                {
                                                    <td></td>
                                                }
                                                @if (Model.AlacakToplam.HasValue)
                                                {
                                                    <td style="text-align: right;"><b>@Model.AlacakToplam.Value.ToString("N") </b></td>
                                                }
                                                else
                                                {
                                                    <td></td>
                                                }
                                                <td style="text-align: right;"><b>@toplamBakiye.Value.ToString("N") </b></td>
                                                @if (toplamBakiye < 0)
                                                {
                                                    <td style="width: 3%; text-align: center; "><b>A</b></td>
                                                }
                                                else
                                                {
                                                    <td style="width: 3%; text-align: center;"><b>B</b></td>
                                                }
                                                <td></td>
                                            </tr>

                                        }
                                    </tbody>
                                </table>
                            }
                            @if (ViewBag.AnaTVM && !Model.AramaDurumu)
                            {
                                <table class="table table-bordered table-hover dataTable data-table" id="sample_1" style="table-layout: inherit">
                                    <thead>
                                        @if (Model.BorcToplam.HasValue)
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white;font-size:15px; "></th>
                                                <th style="width: auto; border-color :white;font-size:15px;">  </th>
                                                <th style="width: auto; border-color :white;font-size:15px;">  </th>
                                                <th style="width: auto; border-color :white;font-size:15px;">   </th>
                                                <th style="width: auto; border-color :white;">C/H Hareket Kontrol Listesi</th>
                                                <th style="width: 15%; border-color :white;font-size:20px;">@Model.baslangicTarihi.ToShortDateString() - @Model.bitisTarihi.ToShortDateString() Vade Tarihleri Arası </th>
                                                <th style="width: auto; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width: auto; border-color :white;"></th>
                                            </tr>
                                        }
                                        else
                                        {
                                            <tr style="background-color:white; border-color :white; font-style: italic;font-size:18px;">
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white; "></th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;">  </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: 10%; border-color :white;"></th>
                                                <th style="width: auto; border-color :white;">    </th>
                                                <th style="width: auto; border-color :white;"> </th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width: auto; border-color :white;">   </th>
                                                <th style="width:  auto; border-color :white;"> </th>
                                            </tr>
                                        }
                                    </thead>
                                    <tbody>
                                        <tr id="baslikRow" style="background-color:#99CCFF !important;">
                                            <th style="width: auto;"> @babonline._expiryDate</th>
                                            <th style="width: auto;"> @babonline._documentDate</th>
                                            <th style="width: auto;"> @babonline._documentType</th>
                                            <th style="width: auto;"> @babonline._paymentType</th>
                                            <th style="width: auto;"> @babonline._documentType </th>
                                            <th style="width: auto;"> Ack.  </th>
                                            <th style="width: auto;"> @babonline._currency </th>
                                            <th style="width: auto;"> @babonline.Debt      </th>
                                            <th style="width: auto;"> @babonline.Receivables    </th>
                                            <th style="width: auto;"> @babonline.CurrentAccountName – @babonline.Code </th>
                                            <th style="width: auto;"> @babonline._customerGroupCode </th>
                                            <th style="width: auto;"> @babonline.Balance </th>

                                        </tr>
                                        @if (Model.list != null && Model.list.Count > 0)
                                        {

                                            foreach (var item in Model.list)
                                            {
                                                if (item.BorcTipi == "A")
                                                {
                                                    <tr style="color:#d70000">
                                                        <td style="width: 4%;">@item.VadeTarihi.ToString("dd.MM.yyyy")</td>
                                                        @if (item.OdemeTarihi.HasValue)
                                                        {
                                                            <td style="width: 4%;">@item.OdemeTarihi.Value.ToString("dd.MM.yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 4%;"></td>
                                                        }
                                                        <td style="width: 6%;">@item.EvrakTipi</td>
                                                        <td style="width: 6%;">@item.OdemeTipi</td>
                                                        <td style="width: 4%;">@item.EvrakNo   </td>
                                                        <td style="width: 10%"> @item.Aciklama  </td>
                                                        <td style="width: 3%;"> @item.ParaBirimi  </td>
                                                        <td style="width: 5%;">@item.Borc.Value.ToString("N")      </td>
                                                        <td style="width: 5%;"> @item.Alacak.Value.ToString("N")    </td>
                                                        <td style="width: 10%"> @item.CariHesapAdiKodu  </td>
                                                        <td style="width: 7%;"> @item.MusteriGrupkodu  </td>

                                                        @{
                                                            var odemeYear = 0;
                                                            var odemeMonth = 0;
                                                            if (item.OdemeTarihi.HasValue)
                                                            {
                                                                odemeYear = item.OdemeTarihi.Value.Year;
                                                                odemeMonth = item.OdemeTarihi.Value.Month;
                                                            }
                                                            else
                                                            {
                                                                odemeYear = item.VadeTarihi.Year;
                                                                odemeMonth = item.VadeTarihi.Month;
                                                            }
                                                        }
                                                        <td style="width: 5%; max-width: 7px">
                                                            <a class="btn btn-mini btn-CariHareketSil" href="javascript:void(0)" id="btnCariHareketSil" id-Kodu=@item.id cari-Hesap-Kodu=@item.CariHesapKodu tvm-kodu="@ViewBag.TVMKodu" donem="@odemeYear" ay="@odemeMonth" borc="@item.Borc" alacak="@item.Alacak" rel="tooltip" data-placement="bottom" data-original-title="@babonline.Delete">
                                                                <i class="icon-remove"></i>
                                                            </a>

                                                        </td>
                                                    </tr>
                                                }
                                                else
                                                {
                                                    <tr>
                                                        <td style="width: 4%;">@item.VadeTarihi.ToString("dd.MM.yyyy")</td>
                                                        @if (item.OdemeTarihi.HasValue)
                                                        {
                                                            <td style="width: 4%;">@item.OdemeTarihi.Value.ToString("dd.MM.yyyy")</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 4%;"></td>
                                                        }
                                                        <td style="width: 6%;">@item.EvrakTipi</td>
                                                        <td style="width: 6%;">@item.OdemeTipi</td>
                                                        <td style="width: 4%;">@item.EvrakNo   </td>
                                                        <td style="width: 10%"> @item.Aciklama  </td>
                                                        <td style="width: 3%;"> @item.ParaBirimi  </td>
                                                        <td style="width: 5%;">@item.Borc.Value.ToString("N")      </td>
                                                        <td style="width: 5%;"> @item.Alacak.Value.ToString("N")    </td>
                                                        <td style="width: 10%"> @item.CariHesapAdiKodu  </td>
                                                        @if (!String.IsNullOrEmpty(item.MusteriGrupkodu))
                                                        {
                                                            <td style="width: 7%;"> @item.MusteriGrupkodu</td>
                                                        }
                                                        else
                                                        {
                                                            <td style="width: 7%;"> </td>
                                                        }
                                                        @{
                                                            var odemeYear = 0;
                                                            var odemeMonth = 0;
                                                            if (item.OdemeTarihi.HasValue)
                                                            {
                                                                odemeYear = item.OdemeTarihi.Value.Year;
                                                                odemeMonth = item.OdemeTarihi.Value.Month;
                                                            }
                                                            else
                                                            {
                                                                odemeYear = item.VadeTarihi.Year;
                                                                odemeMonth = item.VadeTarihi.Month;
                                                            }
                                                        }
                                                        <td style="width: 5%;  max-width: 7px">
                                                            <a class="btn btn-mini btn-CariHareketSil" href="javascript:void(0)" id="btnCariHareketSil" id-Kodu=@item.id cari-Hesap-Kodu=@item.CariHesapKodu tvm-kodu="@ViewBag.TVMKodu" donem="@odemeYear" ay="@odemeMonth" borc="@item.Borc" alacak="@item.Alacak" rel="tooltip" data-placement="bottom" data-original-title="Sil">
                                                                <i class="icon-remove"></i>
                                                            </a>

                                                        </td>
                                                    </tr>
                                                }
                                            }
                                            <tr>
                                                <td><b>@babonline.OverallTotal</b></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                                @if (Model.BorcToplam.HasValue)
                                                {
                                                    <td><b>@Model.BorcToplam.Value.ToString("N") </b></td>
                                                }
                                                else
                                                {
                                                    <td></td>
                                                }
                                                @if (Model.AlacakToplam.HasValue)
                                                {
                                                    <td><b>@Model.AlacakToplam.Value.ToString("N") </b></td>
                                                }
                                                else
                                                {
                                                    <td></td>
                                                }
                                                <td></td>
                                                <td></td>
                                                <td></td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            }
                        </div>
                    </div>
                </div>







            </div>

        </div>
    </div>
</div>

@*Silme İşlemi*@
@Html.Partial("_DeleteConfirmation")