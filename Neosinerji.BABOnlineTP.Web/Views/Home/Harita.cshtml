@model Neosinerji.BABOnlineTP.Web.Models.HaritaIletisimFormModel

@{
    Layout = "~/Views/Shared/_LayoutMap.cshtml";
}
@using Neosinerji.BABOnlineTP.Web.Content.Lang


<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
<html>
<head>
    <meta charset="utf-8" />
    <title>NeoOnline - @babonline.Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="neosinerji" name="author" />
    <link href="@Url.Content("~/favicon.ico")" rel="shortcut icon" type="image/x-icon" />
    @Scripts.Render("~/bundles/phoneinputjs")
    <script src="~/Content/js/jquery.js"></script>
    <script src="~/Content/js/jquery-ui.js"></script>
    <script src="~/Content/js/jquery.validate.js"></script>
    <script src=" https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.15.0/jquery.validate.min.js"> </script>
    <script src="~/Content/js/bootstrap-transition.js"></script>
    <script src="~/Content/js/bootstrap-tooltip.js"></script>
    <script src="~/content/js/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="~/content/js/jquery.blockui.js" type="text/javascript"></script>
    <script src="~/content/js/breakpoints.js" type="text/javascript"></script>
    <script src="~/Content/js/Maps/bootstrap-modal.js" type="text/javascript"></script>
    <script src="~/Content/js/Maps/bootstrap-modalmanager.js" type="text/javascript"></script>
    <link href="~/Content/Angular/css/sweetalert.css" rel="stylesheet" />
    <script src="~/Content/Angular/js/sweetalert.min.js"></script>

    @*<script src="https://maps.google.com/maps/api/js?v=3.25&sensor=true" type="text/javascript"></script>*@
    @* <script async defer    src="https://maps.googleapis.com/maps/api/js?v=3.25
        &key=YOUR_API_KEY&callback=initMap">*@

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC957T4Tr8bbHrMGqru5kroHjw1LBSdsKs" type="text/javascript"></script>

    <script src="~/Content/js/Maps/gmaps.js"></script>
    <script src="~/Content/js/Maps/maps-google.js"></script>
    <script src="~/Content/js/Maps/jquery.backstretch.min.js" type="text/javascript"></script>
    <script src="~/Content/js/Maps/login-soft.js" type="text/javascript"></script>
    <script src="~/Content/js/jquery.validate.unobtrusive.js"></script>
    <script src="~/Content/js/jquery.validate.custom.js"></script>
    <script src="~/content/js/jquery.slimscroll.min.js" type="text/javascript"></script>
    <script src="~/content/js/jquery.blockui.js" type="text/javascript"></script>

    <link href="~/Content/css/themes/default.css" rel="stylesheet" />
    <link href="~/Content/css/uniform.default.css" rel="stylesheet" />
    <link href="~/Content/css/login-soft.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" />
    <link href="~/Content/css/style-metro.css" rel="stylesheet" />
    <link href="~/Content/css/style-responsive.css" rel="stylesheet" />
    <link href="~/Content/css/style.css" rel="stylesheet" />
    <link href="~/Content/css/login-soft.css" rel="stylesheet" />
    <link href="~/Content/css/bootstrap-modal.css" rel="stylesheet" />
    <link href="~/Content/css/custom.css" rel="stylesheet" />

    <script type="text/javascript">
        jQuery(document).ready(function () {
            MapsGoogle.init();
        });
    </script>


    <style>
        .container {
            width: 900px;
            height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .gmaps {
            height: 100% !important;
            width: 100%;
        }

        #firstHeading {
            color: #000;
        }

        #telefon {
            width: 300px;
        }

        .modal {
            margin-left: -133px !important;
            width: auto !important;
        }
    </style>

</head>
<!-- END HEAD -->
<!-- BEGIN BODY -->
<body class="login">
    <!-- BEGIN LOGIN -->
    <div class="content" style="height: 463px; width: 895px;">
        <div class="container">
            <form class="form-inline" action="#">
                <a href="/" id="back-btn" class="btn"><i class="m-icon-swapleft"></i>&nbsp;@babonline.Back</a>
                <input type="text" id="gmap_geocoding_address" class="m-wrap medium" placeholder="@babonline.Address" />
                <input type="button" id="gmap_geocoding_btn" class="btn" value="@babonline.Search" />
                <input type="button" id="get-location" class="btn" value="@babonline.TakeLocation" />
                <input style="display: none" type="button" id="get-acente" class="btn acente-bul" value="@babonline.Find_Nearest_Agency" />
                <a href="/Home/Harita" style="display: none" type="button" id="refresh" class="btn yellow">@babonline.Refresh</a>
            </form>
            <div id="gmap_geocoding" class="gmaps"></div>
        </div>
    </div>
    <!-- END LOGIN -->
    <!-- BEGIN COPYRIGHT -->
    <div class="copyright">
        2020 &copy; Neosinerji - NeoOnline.
    </div>
    <!-- END COPYRIGHT -->
    <!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
    <!-- BEGIN CORE PLUGINS -->

    <!-- END PAGE LEVEL SCRIPTS -->
    <script>
        jQuery(document).ready(function () {
            //App.init();
            Login.init();
        });
    </script>
    <!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>



<div id="stack1" class="modal hide fade" tabindex="-1" data-focus-on="input:first">

    <div class="modal-header">
        <button id="close" type="button" class="close" data-dismiss="modal" aria-hidden="true">
        </button>
        <h3>@babonline.Contact_Info</h3>
    </div>

    <div class="modal-body">
        <form id="form1" class="form-horizontal" method="post">
            @Html.HiddenFor(s => s.TVMKodu)
            @{ Html.EnableClientValidation(true); }
            @Html.ValidationSummary(true, babonline.Message_GenericErrorHeader)
            <div class="control-group">
                <label class="control-label">@babonline.Name_Surname   <span class="required">*</span></label>
                <div class="controls">
                    @Html.TextBoxFor(s => s.AdSoyad, new { style = "width:200px;", placeholder = "Ad Soyad", @class = "m-wrap" })</br>
            @Html.ValidationMessageFor(s => s.AdSoyad)
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">@babonline.EMail_Address <span class="required">*</span></label>
                <div class="controls">
                    @Html.TextBoxFor(s => s.EMail, new { style = "width:200px;", placeholder = "Email", @class = "m-wrap" })</br>
            @Html.ValidationMessageFor(s => s.EMail)
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">@babonline.Phone  </label>
                <div class="controls">
                    @Html.TextBoxFor(s => s.Telefon, new { style = "width:90%", data_format = "dd-ddd-ddddddd", maxlength = 14, minlength = 14, pattern = ".{14,14}", @class = "input-medium bfh-phone", title = babonline.Message_PhoneFormat })
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn">@babonline.Logoff</button>
        <button type="button" class="btn red" id="form-gonder">@babonline.Send</button>
    </div>
</div>

<div id="stackTeklifPolice" class="modal hide fade" tabindex="-1" data-focus-on="input:first">
    <div class="modal-header">
        <button id="close1" type="button" class="close" data-dismiss="modal" aria-hidden="true">
        </button>
        <h3 style="text-align:center; margin-left: 10%;  margin-right: 10%;background-color: #cce6ff;">Müşteri Üye Kayıt Bilgileri</h3>
    </div>

    <div class="modal-body">
        <form id="form2" class="form-horizontal" method="post">
            @Html.HiddenFor(s => s.teklifPoliceModel.TVMKodu)
            @{ Html.EnableClientValidation(true); }
            @Html.ValidationSummary(true, babonline.Message_GenericErrorHeader)
            <div class="control-group">
                <label class="control-label">@babonline.TCKN / VKN / YKN<span class="required">*</span></label>
                <div class="controls">
                    @Html.TextBoxFor(m => m.teklifPoliceModel.tcVkn, new { maxlength = 11, style = "width:120px;", placeholder = "TCKN/VKN giriniz.", @class = "onlynumbers" })
                    <button class="btn btn-info blue" id="kimlik-sorgula" type="button">@babonline.Query</button><br />
                    <span class="text-error" id="kimlikno-mesaj">@babonline.Message_TCKN_VKN_YKN_Required</span>
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">@babonline.Name_Surname   <span class="required">*</span></label>
                <div class="controls">
                    @Html.TextBoxFor(s => s.teklifPoliceModel.AdSoyad, new { style = "width:200px;", disabled = "disabled", placeholder = "Ad Soyad", @class = "m-wrap" })</br>
            @Html.ValidationMessageFor(s => s.AdSoyad)
                </div>
            </div>

            <div class="control-group">
                <label class="control-label">@babonline.EMail_Address <span class="required">*</span></label>
                <div class="controls">
                    @Html.TextBoxFor(s => s.teklifPoliceModel.EMail, new { style = "width:200px;", placeholder = "Email", @class = "m-wrap" })</br>
            @Html.ValidationMessageFor(s => s.EMail)
                </div>
            </div>
            <div class="control-group">
                <label class="control-label">@babonline.Phone  </label>
                <div class="controls">
                    @Html.TextBoxFor(s => s.teklifPoliceModel.Telefon, new { style = "width:90%", data_format = "dd-ddd-ddddddd", placeholder = "90(555)9999999", maxlength = 14, minlength = 14, pattern = ".{14,14}", @class = "input-medium bfh-phone", title = babonline.Message_PhoneFormat })
                </div>
            </div>
            <div><span style="color:red;">* Teklif alabilmeniz için lütfen üyelik kaydınızı gerçekleştiriniz.</span></div>
            <h6>Bilgileriniz güvencemiz altındadır.Seçtiğiniz acente dışında paylaşılmamaktadır. </h6>
          
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" data-dismiss="modal" class="btn">@babonline.Logoff</button>
        <button type="button" class="btn red" id="form2-gonder">@babonline.Save</button>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#kimlik-sorgula").live("click", function () {

            var kimlikno = $("#teklifPoliceModel_tcVkn").val();
            var tvmKod = $("#TVMKodu").val();
            if (kimlikno.length == 11) {
                $.post("/Common/KimlikSorgula", { kimlikNo: kimlikno, tvmKodu: tvmKod }, function (data) {
                    if (data.SorgulamaSonuc) {
                        $("#teklifPoliceModel_AdSoyad").val(data.Ad + " " + data.Soyad);
                        $("#teklifPoliceModel_TVMKodu").val(tvmKod);
                        $("#kimlik-sorgula").button("reset");
                    }
                    else {
                        alert("Bir hata olustu lutfen tekrar deneyin.");

                    }
                });
            }
        });

        $("#form2-gonder").live("click", function () {
            $("#form2").validate().form();
            if ($("#form2").valid()) {
                //var formData = $("#form2").serialize(); 

                var kimlikno = $("#teklifPoliceModel_tcVkn").val();
                var tvmKod = $("#teklifPoliceModel_TVMKodu").val();
                var adSoyad = $("#teklifPoliceModel_AdSoyad").val();
                var email = $("#teklifPoliceModel_EMail").val();
                var telefon = $("#teklifPoliceModel_Telefon").val();
                $.post("/Common/InternetKullaniciAktivasyon", { TVMKodu: tvmKod, tcVkn: kimlikno, adSoyad: adSoyad, email: email, telefon: telefon }, function (data) {
                    if (data.KayitYapildiMi) {
                        //swal("İşlem Başarılı !", data.KayitMesaj, "success");
                        swal({
                            title: "İşlem Başarılı!",
                            text: data.KayitMesaj,
                            type: "success",
                            showCancelButton: false,
                            confirmButtonColor: "#DD6B55",
                            confirmButtonText: "OK",
                            closeOnConfirm: false,
                            closeOnCancel: false
                        },
                                      function (isConfirm) {
                                          if (isConfirm) {
                                              window.location.href = "/Home/Harita";
                                          }
                                      });
                    }
                    else {
                        swal("Hata !", data.KayitMesaj, "error");
                    }
                });
            }
        });
    });
</script>
